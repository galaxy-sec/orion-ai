# Orion AI é¡¹ç›®æ–‡æ¡£

## ğŸš€ é¡¹ç›®æ¦‚è§ˆ

Orion AI æ˜¯ä¸€ä¸ª Rust å®ç°çš„æ™ºèƒ½ AI æ‰§è¡Œå¼•æ“ï¼Œæ”¯æŒå¤š AI æä¾›å•†ã€å‡½æ•°è°ƒç”¨ã€çº¿ç¨‹è®°å½•å’Œè§’è‰²é…ç½®ç®¡ç†ã€‚æä¾›ç»Ÿä¸€çš„æ¥å£ä¸ä¸åŒçš„ AI æ¨¡å‹äº¤äº’ã€‚

## ğŸ“ ä»£ç æ¶æ„

### 1. æ ¸å¿ƒæ¨¡å—ç»“æ„

```
src/
â”œâ”€â”€ client/           # å®¢æˆ·ç«¯å®ç°ï¼ˆOpenAI/DeepSeekç­‰ï¼‰
â”œâ”€â”€ config/           # é…ç½®ç³»ç»Ÿï¼ˆè§’è‰²ã€æ¨¡å‹ã€è§„åˆ™ï¼‰
â”œâ”€â”€ exec_unit/        # æ‰§è¡Œå•å…ƒï¼ˆAiExecUnitï¼‰
â”œâ”€â”€ func/             # å‡½æ•°è°ƒç”¨ç³»ç»Ÿ
â”‚   â”œâ”€â”€ global/       # å…¨å±€æ³¨å†Œç®¡ç†
â”‚   â”œâ”€â”€ system/       # ç³»ç»Ÿå·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ git.rs        # Gitæ“ä½œå‡½æ•°
â”‚   â”œâ”€â”€ registry.rs   # å‡½æ•°æ³¨å†Œå™¨
â”‚   â””â”€â”€ executor.rs   # å‡½æ•°æ‰§è¡Œå™¨
â”œâ”€â”€ providers/        # AIæä¾›å•†å®ç°
â”œâ”€â”€ thread/           # çº¿ç¨‹è®°å½•ç³»ç»Ÿ
â”œâ”€â”€ types/            # ç±»å‹å®šä¹‰
â””â”€â”€ router/           # è¯·æ±‚è·¯ç”±ç³»ç»Ÿ
```

### 2. å…³é”®ç»„ä»¶

#### å®¢æˆ·ç«¯å±‚ (`src/client/`)
- **AiClient**: ç»Ÿä¸€çš„AIè¯·æ±‚å®¢æˆ·ç«¯
- **AiCoreClient**: æ ¸å¿ƒå®¢æˆ·ç«¯å®ç°
- **MockClient**: æµ‹è¯•ç”¨çš„æ¨¡æ‹Ÿå®¢æˆ·ç«¯

#### é…ç½®ç³»ç»Ÿ (`src/config/`)
- **RoleConfigManager**: è§’è‰²é…ç½®ç®¡ç†
- **ConfigLoader**: é…ç½®åŠ è½½å™¨
- **ProviderConfig**: æä¾›å•†é…ç½®
- **RoutingRules**: è·¯ç”±è§„åˆ™

#### å‡½æ•°è°ƒç”¨ç³»ç»Ÿ (`src/func/`)
- **FunctionRegistry**: å‡½æ•°æ³¨å†Œè¡¨
- **FunctionExecutor**: å‡½æ•°æ‰§è¡Œå™¨trait
- **GlobalFunctionRegistry**: å…¨å±€æ³¨å†Œç®¡ç†ä¸­å¿ƒ

#### æ‰§è¡Œå•å…ƒ (`src/exec_unit/`)
- **AiExecUnit**: æ ¸å¿ƒæ‰§è¡Œå•å…ƒï¼Œå°è£…ï¼š
  - AIå®¢æˆ·ç«¯
  - å·¥å…·å‡½æ•°
  - è§’è‰²é…ç½®
  - çº¿ç¨‹è®°å½•
- **AiExecUnitBuilder**: æ„å»ºå™¨æ¨¡å¼

#### çº¿ç¨‹è®°å½• (`src/thread/`)
- **ThreadClient**: çº¿ç¨‹å®¢æˆ·ç«¯åŒ…è£…
- **ThreadFileManager**: æ–‡ä»¶ç®¡ç†å™¨
- **ThreadConfig**: çº¿ç¨‹é…ç½®

### 3. ç³»ç»Ÿå·¥å…·

#### æ”¯æŒçš„å‡½æ•°å·¥å…·

**Gitæ“ä½œï¼ˆ`git/`ï¼‰:**
- `git-status` - æŸ¥çœ‹ä»“åº“çŠ¶æ€
- `git-add <file>` - æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº
- `git-commit <msg>` - æäº¤æ›´æ”¹
- `git-push` - æ¨é€æäº¤
- `git-diff <options>` - æŸ¥çœ‹å·®å¼‚
- `git-log <count>` - æŸ¥çœ‹æäº¤å†å²

**æ–‡ä»¶ç³»ç»Ÿï¼ˆ`system/`ï¼‰:**
- `fs-ls <path>` - åˆ—å‡ºç›®å½•å†…å®¹
- `fs-cat <file>` - æŸ¥çœ‹æ–‡ä»¶å†…å®¹
- `fs-find <pattern>` - æœç´¢æ–‡ä»¶
- `fs-pwd` - å½“å‰å·¥ä½œç›®å½•

**ç³»ç»Ÿä¿¡æ¯ï¼ˆ`system/`ï¼‰:**
- `sys-uname` - ç³»ç»Ÿä¿¡æ¯
- `sys-ps` - è¿›ç¨‹åˆ—è¡¨
- `sys-df` - ç£ç›˜ä½¿ç”¨æƒ…å†µ
- `net-ping <host>` - ç½‘ç»œè¿é€šæ€§æµ‹è¯•

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
cargo build --release
```

### 2. åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹

```rust
use orion_ai::*;

#[tokio::main]
async fn main() {
    // åˆå§‹åŒ–å…¨å±€å‡½æ•°æ³¨å†Œè¡¨
    GlobalFunctionRegistry::initialize().unwrap();
    
    // åˆ›å»ºAIæ‰§è¡Œå•å…ƒ
    let exec_unit = AiExecUnitBuilder::new(load_config())
        .with_role("developer")
        .with_tools(vec!["git-status".to_string(), "fs-ls".to_string()])
        .build();
    
    // æ‰§è¡Œæ™ºèƒ½è¯·æ±‚
    let result = exec_unit.smart_request(
        "æŸ¥çœ‹å½“å‰gitçŠ¶æ€".to_string()
    ).await.unwrap();
    
    println!("ç»“æœ: {}", result);
}
```

### 3. é…ç½®ç»“æ„

é…ç½®æ–‡ä»¶ä½äº `./_gal/` ç›®å½•ï¼š

```
_gal/
â”œâ”€â”€ ai.yml           # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ ai-roles.yml    # è§’è‰²é…ç½®
â”œâ”€â”€ ai-roles/[role]/ # è§’è‰²è§„åˆ™æ–‡ä»¶
â”œâ”€â”€ env/            # ç¯å¢ƒå˜é‡
â””â”€â”€ secret/         # å¯†é’¥æ–‡ä»¶
```

## ğŸ“Š æ€§èƒ½ç‰¹ç‚¹

- **çº¿ç¨‹å®‰å…¨**: ä½¿ç”¨ `OnceLock<Arc<RwLock>>` å®ç°
- **é›¶æ‹·è´**: åŸºäº Rust çš„æ‰€æœ‰æƒç³»ç»Ÿ
- **å¼‚æ­¥æ‰§è¡Œ**: åŸºäº Tokio runtime
- **å¯é€‰ç¼“å­˜**: å“åº”ç¼“å­˜æ”¯æŒ

## ğŸ” å®‰å…¨é…ç½®

### å¯†é’¥ç®¡ç†
ç¯å¢ƒå˜é‡æˆ– `_gal/secret/` æ–‡ä»¶ï¼š
- `OPENAI_API_KEY`
- `DEEPSEEK_API